<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>八年級的回憶攻擊</title>
  <style>
    :root {
      --primary:#a67c52;        /* 主色：咖啡棕 */
      --primary-hover:#8c6239;  /* 主色 hover */
      --bg:#fdf8f2;             /* 背景：暖米白 */
      --card:#fffaf5;           /* 卡片：米杏 */
      --text:#4a3b2b;           /* 文字：深咖啡 */
      --line:#e8dccf;           /* 邊線：淺卡其 */
      --pill:#eee3d7;           /* 膠囊底色 */
      --pillText:#5b4632;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background:var(--bg); color:var(--text); -webkit-tap-highlight-color: transparent;
    }
    .wrap{max-width:720px;margin:0 auto;padding:16px 16px 72px}
    header{text-align:center;margin:16px 0 24px}
    h1{font-size:30px;margin:0;font-weight:800;letter-spacing:.5px}
    .card{
      background:var(--card);border-radius:16px;padding:16px;border:1px solid var(--line);
      box-shadow:0 6px 20px rgba(0,0,0,.04)
    }
    .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .btn{
      appearance:none;border:1px solid transparent;border-radius:12px;padding:12px 16px;
      background:var(--primary);color:#fff;font-weight:700;cursor:pointer;min-width:140px;
      transition:background .2s, transform .02s; text-align:center;
    }
    .btn:hover{background:var(--primary-hover)}
    .btn:active{transform:translateY(1px)}
    .btn[disabled]{opacity:.55;cursor:not-allowed}
    .q-text{font-size:18px;line-height:1.55;margin:0 0 12px}
    .choice{
      border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff;
      display:flex;align-items:center;gap:10px
    }
    .choice input{width:20px;height:20px}
    .meta{display:flex;justify-content:space-between;align-items:center;font-size:14px;color:#6b5c4a;margin:8px 0 16px}
    .pill{padding:6px 10px;border-radius:999px;background:var(--pill);color:var(--pillText);font-weight:700}
    .timer{font-variant-numeric:tabular-nums; visibility:hidden;}
    .footer{
      position:fixed;left:0;right:0;bottom:0;background:rgba(253,248,242,.96);
      border-top:1px solid var(--line);backdrop-filter: blur(6px)
    }
    .footer .inner{
      max-width:720px;margin:0 auto;padding:12px 16px;display:flex;gap:12px;flex-wrap:wrap;justify-content:center
    }
    .result h2{margin:0 0 8px}
    .small{font-size:12px;color:#6b5c4a}
    .hidden{display:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1 id="title">八年級的回憶攻擊</h1>
    </header>

    <div id="last" class="card" style="display:none;margin-bottom:12px;"></div>

    <div id="quiz" class="card hidden">
      <div class="meta">
        <div><span id="progress" class="pill">1/1</span></div>
        <div class="timer">剩餘 <span id="remain">10:00</span></div>
      </div>
      <h2 id="q" class="q-text"></h2>
      <div id="choices" style="display:grid;gap:10px;"></div>
    </div>

    <div id="result" class="card hidden"></div>

    <div id="home" class="card">
      <p style="margin:0 0 12px;">選擇模式開始作答：</p>
      <div class="row" style="margin-top:8px;justify-content:center">
        <button id="start-free" class="btn">開始測驗（不限時）</button>
        <button id="start-10m" class="btn">開始測驗（限時 10 分鐘）</button>
      </div>
    </div>
  </div>

  <div class="footer">
    <div class="inner">
      <button id="back" class="btn hidden">返回</button>
      <button id="next" class="btn hidden" disabled>下一題</button>
      <button id="submit" class="btn hidden">交卷</button>
    </div>
  </div>

<script>
/** ===== 題庫（含 3 題是非題） ===== */
const DEFAULT_BANK = [
  {"q":"哪個是「小朋友齊打交2」的隱藏角色?","choices":["冰人(Freeze)","忍者(Rudolf)","邪鬼(Julian)","弓箭手(Henry)"],"answer":2},
  {"q":"台灣流行男子音樂團體「四大天王」成員不包含誰?","choices":["羅志祥","歐漢聲","陳霆叡","張學友"],"answer":3},
  {"q":"在蕃薯藤養番薯寶寶，無法養下列哪種呀米?","choices":["溫柔呀米","漂亮呀米","氣質呀米","可愛呀米"],"answer":1},
  {"q":"庫洛魔法使中，庫洛牌共有幾張?(漫畫+動畫+劇場版)","choices":["48","54","62","32"],"answer":1},
  {"q":"2012年由15所高中原創的畢業歌，歌名為何?","choices":["風箏","紙飛機","珍重再見","乾杯"],"answer":0},
  {"q":"PTT三大神器不包含下列何者?","choices":["排骨酥湯","大同電鍋","台科大學生證","Nokia 3310"],"answer":0},
  {"q":"「伐伐伐伐伐伐伐伐木工」這段語音是出自哪個遊戲?","choices":["世紀帝國","紅色警戒","美少女夢工廠","楓之谷"],"answer":0},
  {"q":"「烏咪沒有犯罪」這段台詞是出自於哪個遊戲?","choices":["大富翁4","忍豆風雲","美少女夢工廠","跑跑卡丁車"],"answer":0},
  {"q":"曾經有位衛兵說了一句名言「我以前和你一樣也是個冒險家，直到我的OO中了一箭。」","choices":["眼睛","手肘","膝蓋","屁股"],"answer":2},
  {"q":"「藍色蜘蛛網」、「玫瑰瞳鈴眼」中旁白的經典台詞是「O組長眉頭一皺，發覺案情並不單純」","choices":["黃","林","王","李"],"answer":3},
  {"q":"手機遊戲「部落衝突」廣告中的經典台詞是「OO騎士來囉~」","choices":["野豬","黑龍","聖域","皇家"],"answer":0},
  {"q":"「唐伯虎點秋香」中唐伯虎於華府的僕役編號是多少?","choices":["9527","0204","24601","55688"],"answer":0},
  {"q":"台詞「讓她生！讓她生！」是出自於哪部電影?","choices":["讓子彈飛","九品芝麻官","功夫","嚦咕嚦咕新年財"],"answer":1},
  {"q":"「終極一班」中，汪大東位於KO榜上第幾名?","choices":["1","5","3","6"],"answer":2},
  {"q":"「終極一班」中，汪大東的武器是下列何者?","choices":["石中劍","龍紋鏊","阿瑞斯之手","楓葉拳套"],"answer":1},
  {"q":"XDDD和俊朗朗朗是相同意思","choices":["是","否"],"answer":0},
  {"q":"「這我一定吉」的意思是今天一定會中獎","choices":["是","否"],"answer":1},
  {"q":"「這種要求我這輩子沒見過」這句話中的「要求」是指送別人錢","choices":["是","否"],"answer":1},
  {"q":"「娘子，快跟牛魔王出來看上帝」這段台詞是出自於「唐伯虎點秋香」","choices":["是","否"],"answer":1},
  {"q":"PTT上曾有一位於國產遊戲《仙劍奇俠傳》成神的人，名曰「十里坡劍神」","choices":["是","否"],"answer":0},
  {"q":"「YOOOOOOOOOO！！」常見於正太相關主題的文章留言區","choices":["是","否"],"answer":1}
];

const $ = sel => document.querySelector(sel);

let bank=[], idx=0, score=0, selected=null;
let enableTimer=false, duration=0, remaining=0, tick=null, startedAt=null;

/* 工具：隨機排序 */
function shuffle(arr){ return arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(v=>v[1]); }
function toMMSS(sec){ const m=Math.floor(sec/60), s=sec%60; return `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`; }

/* 事件 */
$('#start-free').onclick=()=>startQuiz({timed:false});
$('#start-10m').onclick=()=>startQuiz({timed:true, seconds:600});
$('#back').onclick=goHome;
$('#next').onclick=goNext;
$('#submit').onclick=finishQuiz;

/* 開始測驗 */
function startQuiz({timed, seconds=0}){
  bank = shuffle(DEFAULT_BANK);         // 題目隨機
  bank.forEach(q=>{
    const withIdx = q.choices.map((t,i)=>({t,i}));
    const shuf = shuffle(withIdx);
    q._choices = shuf.map(x=>x.t);      // 選項隨機
    q._answer  = shuf.findIndex(x=>x.i===q.answer); // 更新答案索引
  });

  idx = 0; score = 0; selected = null;
  enableTimer = !!timed; duration = seconds; remaining = duration;
  startedAt = Date.now();
  clearInterval(tick);

  // 顯示/隱藏
  $('#home').classList.add('hidden');
  $('#result').classList.add('hidden');
  $('#quiz').classList.remove('hidden');
  $('#back').classList.remove('hidden');     // 測驗一開始就有返回
  $('#next').classList.remove('hidden');     // 有下一題（除非只有 1 題）
  $('#submit').classList.add('hidden');      // 不是最後一題，不顯示交卷
  $('#next').disabled = true;                // 未選前禁用

  // 計時器
  $('.timer').style.visibility = enableTimer ? 'visible' : 'hidden';
  $('#remain').textContent = enableTimer ? toMMSS(remaining) : '—';
  if(enableTimer){
    tick = setInterval(()=>{
      remaining--;
      $('#remain').textContent = toMMSS(Math.max(0,remaining));
      if(remaining<=0){ finishQuiz(); }
    },1000);
  }

  renderQuestion();
}

/* 渲染題目 */
function renderQuestion(){
  const q = bank[idx];
  $('#progress').textContent = `${idx+1}/${bank.length}`;
  $('#q').textContent = q.q;

  const box = $('#choices'); box.innerHTML = '';
  q._choices.forEach((text,i)=>{
    const div = document.createElement('label');
    div.className = 'choice';
    div.innerHTML = `<input type="radio" name="c${idx}" /> <span>${text}</span>`;
    div.onclick = () => { selected = i; updateFooterButtons(); };
    box.appendChild(div);
  });

  updateFooterButtons();
}

/* 更新底部按鈕狀態與顯示 */
function updateFooterButtons(){
  const isLast = (idx === bank.length - 1);

  if(isLast){
    // 最後一題：只顯示交卷
    $('#back').classList.add('hidden');
    $('#next').classList.add('hidden');
    $('#submit').classList.remove('hidden');
    // 交卷不需要在選擇前禁用，讓使用者可不作答直接交卷（若想強制作答可在此加 disabled 控制）
  }else{
    // 中途：顯示返回 + 下一題，不顯示交卷
    $('#back').classList.remove('hidden');
    $('#submit').classList.add('hidden');
    $('#next').classList.remove('hidden');
    // 未作答時禁用下一題
    $('#next').disabled = (selected === null);
  }
}

/* 下一題 */
function goNext(){
  if(selected === bank[idx]._answer) score++;
  idx++;
  selected = null;
  renderQuestion();
}

/* 返回首頁（不顯示分數） */
function goHome(){
  clearInterval(tick);
  $('#quiz').classList.add('hidden');
  $('#result').classList.add('hidden');
  $('#home').classList.remove('hidden');

  // 開始前底部按鈕一律隱藏
  $('#back').classList.add('hidden');
  $('#next').classList.add('hidden');
  $('#submit').classList.add('hidden');
}

/* 交卷（最後一題） */
function finishQuiz(){
  clearInterval(tick);
  if(selected !== null && idx < bank.length){
    if(selected === bank[idx]._answer) score++;
  }
  const elapsed = Math.max(1, Math.round((Date.now()-startedAt)/1000));
  const total = bank.length;
  const pct = Math.round((score/total)*100);

  $('#result').innerHTML = `
    <h2>成績：${score} / ${total}</h2>
    <p class="small">正確率 ${pct}% ・ 花費 ${elapsed} 秒${enableTimer?`（限時 ${duration/60} 分鐘）`:''}</p>
    <div class="row" style="margin-top:8px;justify-content:center">
      <button class="btn" onclick="startQuiz({timed:${enableTimer},seconds:${duration}})">再測一次</button>
      <button class="btn" onclick="goHome()">回首頁</button>
    </div>
  `;

  $('#quiz').classList.add('hidden');
  $('#home').classList.add('hidden');
  $('#result').classList.remove('hidden');

  // 結束後底部按鈕也隱藏
  $('#back').classList.add('hidden');
  $('#next').classList.add('hidden');
  $('#submit').classList.add('hidden');
}
</script>
</body>
</html>



